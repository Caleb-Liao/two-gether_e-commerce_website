(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0bdcec"],{"2e25":function(e,t,o){"use strict";o.r(t);var a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"couponList"},[o("div",{staticClass:"couponsTopBtn"},[o("el-button",{on:{click:function(t){return e.openModal("new")}}},[e._v("新增優惠券")])],1),o("couponmodal",{ref:"couponModal",attrs:{"dialog-visible":e.dialogVisible,"is-new":e.isNew},on:{update:e.getCoupons,"dialog-cancel":function(t){e.dialogVisible=!1}}}),o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.couponList}},[o("el-table-column",{attrs:{label:"名稱",prop:"title",width:"180"}}),o("el-table-column",{attrs:{label:"序號",prop:"code",width:"200",align:"center",sortable:""}}),o("el-table-column",{attrs:{label:"折扣百分比",prop:"percent",width:"150",align:"center",sortable:""}}),o("el-table-column",{attrs:{label:"到期時間",prop:"deadline.datetime",width:"200",align:"center",sortable:""}}),o("el-table-column",{attrs:{label:"是否啟用",prop:"enabled",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return o("div",{},[t.row.enabled?o("span",{staticStyle:{color:"#c02c38"}},[e._v("啟用")]):o("span",[e._v("未啟用")])])}}])}),o("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"mini"},on:{click:function(o){return e.openModal("edit",t.row.id)}}},[e._v("編輯")]),o("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(o){return e.deleteItem(t.row)}}},[e._v("刪除")])]}}])})],1)],1)},n=[],i=(o("99af"),function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("el-dialog",{attrs:{title:"新增優惠券",visible:e.dialogVisible,top:"5vh","before-close":e.cancel},on:{"update:visible":function(t){e.dialogVisible=t}}},[o("el-form",{attrs:{"label-width":"80px"}},[o("el-form-item",{attrs:{label:"名稱"}},[o("el-input",{staticClass:"couponModalInput",model:{value:e.tempCoupon.title,callback:function(t){e.$set(e.tempCoupon,"title",t)},expression:"tempCoupon.title"}})],1),o("el-form-item",{attrs:{label:"序號"}},[o("el-input",{staticClass:"couponModalInput",model:{value:e.tempCoupon.code,callback:function(t){e.$set(e.tempCoupon,"code",t)},expression:"tempCoupon.code"}})],1),o("el-form-item",{attrs:{label:"折扣比例"}},[o("el-input",{staticClass:"couponModalInput",model:{value:e.tempCoupon.percent,callback:function(t){e.$set(e.tempCoupon,"percent",e._n(t))},expression:"tempCoupon.percent"}}),e._v(" % ")],1),!1===this.isNew?o("el-form-item",{attrs:{label:"舊到期日"}},[o("el-date-picker",{attrs:{disabled:"",type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss","default-time":"23:59:59"},model:{value:e.tempCoupon.deadline.datetime,callback:function(t){e.$set(e.tempCoupon.deadline,"datetime",t)},expression:"tempCoupon.deadline.datetime"}})],1):e._e(),o("el-form-item",{attrs:{label:"到期時間"}},[o("el-date-picker",{attrs:{type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss","default-time":"23:59:59"},model:{value:e.tempCoupon.deadline_at,callback:function(t){e.$set(e.tempCoupon,"deadline_at",t)},expression:"tempCoupon.deadline_at"}})],1),o("el-form-item",{attrs:{label:"是否啟用"}},[o("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},model:{value:e.tempCoupon.enabled,callback:function(t){e.$set(e.tempCoupon,"enabled",t)},expression:"tempCoupon.enabled"}})],1),o("el-form-item",{staticClass:"couponModalBtn"},[o("el-button",{attrs:{type:"primary"},on:{click:e.updateCoupon}},[e._v("儲存")]),o("el-button",{on:{click:e.cancel}},[e._v("取消")])],1)],1)],1)}),l=[],c={data:function(){return{tempCoupon:{title:"",code:"",percent:0,enabled:!0,deadline_at:"",deadline:{datetime:""}}}},props:{dialogVisible:{type:Boolean,required:!0},isNew:{type:Boolean,required:!0}},methods:{cancel:function(){this.$emit("dialog-cancel")},getCoupon:function(e){var t=this,o="".concat("https://course-ec-api.hexschool.io","/api/").concat("f6274412-caf4-4237-aca4-557a5d22b124","/admin/ec/coupon/").concat(e);this.axios.get(o).then((function(e){t.tempCoupon=e.data.data}))},updateCoupon:function(){var e=this,t="",o="";this.isNew?(t="".concat("https://course-ec-api.hexschool.io","/api/").concat("f6274412-caf4-4237-aca4-557a5d22b124","/admin/ec/coupon"),o="post"):this.isNew||(t="".concat("https://course-ec-api.hexschool.io","/api/").concat("f6274412-caf4-4237-aca4-557a5d22b124","/admin/ec/coupon/").concat(this.tempCoupon.id),o="patch"),this.axios[o](t,this.tempCoupon).then((function(){e.cancel(),e.$emit("update")}))}}},s=c,p=o("2877"),u=Object(p["a"])(s,i,l,!1,null,null,null),d=u.exports,r={components:{couponmodal:d},data:function(){return{dialogVisible:!1,isNew:!0,loading:!1,couponId:"",couponList:[]}},created:function(){this.getCoupons()},methods:{getCoupons:function(){var e=this;this.loading=!0;var t="".concat("https://course-ec-api.hexschool.io","/api/").concat("f6274412-caf4-4237-aca4-557a5d22b124","/admin/ec/coupons");this.axios.get(t).then((function(t){e.couponList=t.data.data,e.loading=!1}))},openModal:function(e,t){var o=this;switch(e){case"new":this.$refs.couponModal.tempCoupon={},this.isNew=!0,this.dialogVisible=!0;break;case"edit":this.couponId=t,this.$refs.couponModal.getCoupon(this.couponId),this.isNew=!1,this.loading=!0,setTimeout((function(){o.dialogVisible=!0,o.loading=!1}),1500);break;default:break}},deleteItem:function(e){var t=this;this.$confirm("確定要刪除 ".concat(e.title," 嗎？"),"提示",{confirmButtonText:"確定",cancelButtonText:"取消",type:"warning"}).then((function(){t.$message({type:"success",message:"刪除成功!"}),t.loading=!0;var o="".concat("https://course-ec-api.hexschool.io","/api/").concat("f6274412-caf4-4237-aca4-557a5d22b124","/admin/ec/coupon/").concat(e.id);t.axios.delete(o).then((function(){t.getCoupons()}))})).catch((function(){}))}}},m=r,f=Object(p["a"])(m,a,n,!1,null,null,null);t["default"]=f.exports}}]);
//# sourceMappingURL=chunk-2d0bdcec.19612e90.js.map
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d2e8c86e"],{"1dde":function(t,e,o){var n=o("d039"),a=o("b622"),i=o("2d00"),c=a("species");t.exports=function(t){return i>=51||!n((function(){var e=[],o=e.constructor={};return o[c]=function(){return{foo:1}},1!==e[t](Boolean).foo}))}},"24a5":function(t,e,o){},"2e25":function(t,e,o){"use strict";o.r(e);var n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"couponList"},[o("div",{staticClass:"couponsTopBtn"},[o("el-button",{on:{click:function(e){return t.openModal("new")}}},[t._v("新增優惠券")])],1),o("couponmodal",{ref:"couponModal",attrs:{"dialog-visible":t.dialogVisible,"is-new":t.isNew},on:{update:t.getCoupons,"dialog-cancel":function(e){t.dialogVisible=!1}}}),o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.couponList}},[o("el-table-column",{attrs:{label:"名稱",prop:"title",width:"180"}}),o("el-table-column",{attrs:{label:"序號",prop:"code",width:"200",align:"center",sortable:""}}),o("el-table-column",{attrs:{label:"折扣百分比",prop:"percent",width:"150",align:"center",sortable:""}}),o("el-table-column",{attrs:{label:"到期時間",prop:"deadline.datetime",width:"200",align:"center",sortable:""}}),o("el-table-column",{attrs:{label:"是否啟用",prop:"enabled",width:"100",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return o("div",{},[e.row.enabled?o("span",{staticStyle:{color:"#c02c38"}},[t._v("啟用")]):o("span",[t._v("未啟用")])])}}])}),o("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"mini"},on:{click:function(o){return t.openModal("edit",e.row.id)}}},[t._v("編輯")]),o("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(o){return t.deleteItem(e.row)}}},[t._v("刪除")])]}}])})],1)],1)},a=[],i=(o("99af"),function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("el-dialog",{attrs:{title:"新增優惠券",visible:t.dialogVisible,width:t.modalWidth,top:"5vh","before-close":t.cancel},on:{"update:visible":function(e){t.dialogVisible=e}}},[o("el-form",{attrs:{"label-width":"80px"}},[o("el-form-item",{attrs:{label:"名稱"}},[o("el-input",{staticClass:"couponModalInput",model:{value:t.tempCoupon.title,callback:function(e){t.$set(t.tempCoupon,"title",e)},expression:"tempCoupon.title"}})],1),o("el-form-item",{attrs:{label:"序號"}},[o("el-input",{staticClass:"couponModalInput",model:{value:t.tempCoupon.code,callback:function(e){t.$set(t.tempCoupon,"code",e)},expression:"tempCoupon.code"}})],1),o("el-form-item",{attrs:{label:"折扣比例"}},[o("el-input",{staticClass:"couponModalInput",model:{value:t.tempCoupon.percent,callback:function(e){t.$set(t.tempCoupon,"percent",t._n(e))},expression:"tempCoupon.percent"}}),t._v(" % ")],1),!1===this.isNew?o("el-form-item",{attrs:{label:"舊到期日"}},[o("el-date-picker",{attrs:{disabled:"",type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss","default-time":"23:59:59"},model:{value:t.tempCoupon.deadline.datetime,callback:function(e){t.$set(t.tempCoupon.deadline,"datetime",e)},expression:"tempCoupon.deadline.datetime"}})],1):t._e(),o("el-form-item",{attrs:{label:"到期時間"}},[o("el-date-picker",{attrs:{type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss","default-time":"23:59:59"},model:{value:t.tempCoupon.deadline_at,callback:function(e){t.$set(t.tempCoupon,"deadline_at",e)},expression:"tempCoupon.deadline_at"}})],1),o("el-form-item",{attrs:{label:"是否啟用"}},[o("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},model:{value:t.tempCoupon.enabled,callback:function(e){t.$set(t.tempCoupon,"enabled",e)},expression:"tempCoupon.enabled"}})],1),o("el-form-item",{staticClass:"couponModalBtn"},[o("el-button",{attrs:{type:"primary"},on:{click:t.updateCoupon}},[t._v("儲存")]),o("el-button",{on:{click:t.cancel}},[t._v("取消")])],1)],1)],1)}),c=[],l={data:function(){return{tempCoupon:{title:"",code:"",percent:0,enabled:!0,deadline_at:"",deadline:{datetime:""}},modalWidth:""}},props:{dialogVisible:{type:Boolean,required:!0},isNew:{type:Boolean,required:!0}},created:function(){window.addEventListener("resize",this.detectWindowWidth)},methods:{cancel:function(){this.$emit("dialog-cancel")},getCoupon:function(t){var e=this,o="".concat("https://course-ec-api.hexschool.io","/api/").concat("f6274412-caf4-4237-aca4-557a5d22b124","/admin/ec/coupon/").concat(t);this.axios.get(o).then((function(t){e.tempCoupon=t.data.data})).catch((function(t){console.log("錯誤:",t)}))},updateCoupon:function(){var t=this,e="",o="";this.isNew?(e="".concat("https://course-ec-api.hexschool.io","/api/").concat("f6274412-caf4-4237-aca4-557a5d22b124","/admin/ec/coupon"),o="post"):this.isNew||(e="".concat("https://course-ec-api.hexschool.io","/api/").concat("f6274412-caf4-4237-aca4-557a5d22b124","/admin/ec/coupon/").concat(this.tempCoupon.id),o="patch"),this.axios[o](e,this.tempCoupon).then((function(){t.cancel(),t.$emit("update")})).catch((function(t){console.log("錯誤:",t)}))},detectWindowWidth:function(){window.innerWidth<1200?this.modalWidth="90%":this.modalWidth="30%"}}},s=l,r=(o("337f"),o("2877")),u=Object(r["a"])(s,i,c,!1,null,null,null),d=u.exports,p={name:"coupons",components:{couponmodal:d},data:function(){return{dialogVisible:!1,isNew:!0,loading:!1,couponId:"",couponList:[]}},created:function(){this.getCoupons()},methods:{getCoupons:function(){var t=this;this.loading=!0;var e="".concat("https://course-ec-api.hexschool.io","/api/").concat("f6274412-caf4-4237-aca4-557a5d22b124","/admin/ec/coupons");this.axios.get(e).then((function(e){t.couponList=e.data.data,t.loading=!1})).catch((function(t){console.log(t)}))},openModal:function(t,e){var o=this;switch(t){case"new":this.$refs.couponModal.tempCoupon={},this.isNew=!0,this.dialogVisible=!0;break;case"edit":this.couponId=e,this.$refs.couponModal.getCoupon(this.couponId),this.isNew=!1,this.loading=!0,setTimeout((function(){o.dialogVisible=!0,o.loading=!1}),1500);break;default:break}},deleteItem:function(t){var e=this;this.$confirm("確定要刪除 ".concat(t.title," 嗎？"),"提示",{confirmButtonText:"確定",cancelButtonText:"取消",type:"warning"}).then((function(){e.$message({type:"success",message:"刪除成功!"}),e.loading=!0;var o="".concat("https://course-ec-api.hexschool.io","/api/").concat("f6274412-caf4-4237-aca4-557a5d22b124","/admin/ec/coupon/").concat(t.id);e.axios.delete(o).then((function(){e.getCoupons()}))}))}}},f=p,m=(o("c9f9"),Object(r["a"])(f,n,a,!1,null,null,null));e["default"]=m.exports},"337f":function(t,e,o){"use strict";var n=o("24a5"),a=o.n(n);a.a},4339:function(t,e,o){},"65f0":function(t,e,o){var n=o("861d"),a=o("e8b5"),i=o("b622"),c=i("species");t.exports=function(t,e){var o;return a(t)&&(o=t.constructor,"function"!=typeof o||o!==Array&&!a(o.prototype)?n(o)&&(o=o[c],null===o&&(o=void 0)):o=void 0),new(void 0===o?Array:o)(0===e?0:e)}},8418:function(t,e,o){"use strict";var n=o("c04e"),a=o("9bf2"),i=o("5c6c");t.exports=function(t,e,o){var c=n(e);c in t?a.f(t,c,i(0,o)):t[c]=o}},"99af":function(t,e,o){"use strict";var n=o("23e7"),a=o("d039"),i=o("e8b5"),c=o("861d"),l=o("7b0b"),s=o("50c4"),r=o("8418"),u=o("65f0"),d=o("1dde"),p=o("b622"),f=o("2d00"),m=p("isConcatSpreadable"),h=9007199254740991,b="Maximum allowed index exceeded",v=f>=51||!a((function(){var t=[];return t[m]=!1,t.concat()[0]!==t})),g=d("concat"),w=function(t){if(!c(t))return!1;var e=t[m];return void 0!==e?!!e:i(t)},C=!v||!g;n({target:"Array",proto:!0,forced:C},{concat:function(t){var e,o,n,a,i,c=l(this),d=u(c,0),p=0;for(e=-1,n=arguments.length;e<n;e++)if(i=-1===e?c:arguments[e],w(i)){if(a=s(i.length),p+a>h)throw TypeError(b);for(o=0;o<a;o++,p++)o in i&&r(d,p,i[o])}else{if(p>=h)throw TypeError(b);r(d,p++,i)}return d.length=p,d}})},c9f9:function(t,e,o){"use strict";var n=o("4339"),a=o.n(n);a.a},e8b5:function(t,e,o){var n=o("c6b6");t.exports=Array.isArray||function(t){return"Array"==n(t)}}}]);
//# sourceMappingURL=chunk-d2e8c86e.a58ed0b4.js.map